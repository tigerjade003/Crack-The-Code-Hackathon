#importing stuff needed for the file
import sqlite3
from encryption import gethash
import os.path

#Creating the database
database = sqlite3.connect("password.db")
cur = database.cursor()
cur.execute("CREATE TABLE IF NOT EXISTS user(hash, hexhash)")
works = bool(False)
counter = 0
#creating it if the file is not created/resetting the file to what is on file in "passwords.txt"
def start():
    if(os.path.isfile("passwords.txt")):
        cur.execute("DELETE FROM user")
        cur.execute("CREATE TABLE IF NOT EXISTS user(hash, hexhash)")
        f = open("passwords.txt", "r")
        Lines = f.readlines()
        for a in Lines:
            e = a.split()
            for k in e:
                k.strip()
            cur.execute("INSERT INTO user VALUES (?, ?)", e)
    global counter
    global works
    works = bool(False)
    counter = 0
#this is to create an entry
def create():
    username = input("Please Enter Your UserName: ")
    password = input("Please Enter Your Password: ")
    e = gethash(username, password)
    params = (e.a, e.b)
    cur.execute("INSERT INTO user VALUES (?, ?)", params)
    global works
    if not works:
        works = bool(True)
        start()
    global counter
    counter+=1
#this is to check if something exists
def check(hash1, hash2):
    cur.execute("SELECT * FROM database WHERE hash = ?", (hash1,))
    cur.execute("SELECT * FROM database WHERE hexhash = ?", (hash2,))
    row1 = cur.fetchone()
    row2 = cur.fetchone()
    if(row1 is not None and row2 is not None):
        return bool(True)
    return bool(False)
